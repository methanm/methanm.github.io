
<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8" /><title>More on Racket</title>
        <meta name="author" content="Ethan">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta property="og:site_name" content="">
        <!--<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" type="text/css" />-->
        <link rel="stylesheet" href="https://methanm.github.io/css/style.css" type="text/css">
        <link rel="stylesheet" href="https://methanm.github.io/css/pygments.css" type="text/css">
        <link rel="stylesheet" href="https://methanm.github.io/fancybox/jquery.fancybox.css" type="text/css">
        <link rel="stylesheet" href="https://methanm.github.io/scrollLoading/style.css" type="text/css">

        <link href='//fonts.googleapis.com/css?family=Titillium+Web:300,400,600' rel='stylesheet' type='text/css'>
        <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <link rel="shortcut icon" href="https://methanm.github.io/favicon.ico" type="image/x-icon">
        <link rel="icon" href="https://methanm.github.io/favicon.ico" type="image/x-icon">
        <link rel="apple-apple-touch-icon" href="https://methanm.github.io/apple-touch-icon-iphone-60x60.png">
        <link rel="apple-apple-touch-icon" sizes="60x60" href="https://methanm.github.io/apple-touch-icon-ipad-76x76.png">
        <link rel="apple-apple-touch-icon" sizes="114x114" href="https://methanm.github.io/apple-touch-icon-iphone-retina-120x120.png">
        <link rel="apple-apple-touch-icon" sizes="144x144" href="https://methanm.github.io/apple-touch-icon-ipad-retina-152x152.png">
        <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>

<body>
    <div id="wrap">
        <header id="header">
<div id="header-outer" class="outer">
    <div class="container">
        <div class="container-inner">
            <div id="header-title">
                <h1 class="logo-wrap">
                    <a href="https://methanm.github.io/" class="logo">Ethan's Thoughts</a>
                </h1>

                <h2 class="subtitle-wrap">
                    <p class="subtitle">I write what I think.</p>
                </h2>

            </div>
            <div id="header-inner" class="nav-container">
                <a id="main-nav-toggle" class="nav-icon"></a>
                <div class="nav-container-inner">
                    <ul id="main-nav">
                                <li class="main-nav-list-item"><a class="main-nav-list-link" href="https://methanm.github.io/">Home</a></li>
                                <li class="main-nav-list-item"><a class="main-nav-list-link" href="https://methanm.github.io/archives">Archives</a></li>
                                <li class="main-nav-list-item"><a class="main-nav-list-link" href="https://methanm.github.io/about">About</a></li>
                    </ul>
                    <nav id="sub-nav">
                    <div id="search-form-wrap">
                        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="q" value="site:https://methanm.github.io/https://methanm.github.io/"></form>
                    </div>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>
</header>

        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
                            <h1 class="header">Article</h1>
                        </div>
                        <div class="main-body-content">
                            






<article class="article article-single article-type-article" itemscope="" itemprop="blogarticle">
    <div class="article-inner">

        <header class="article-header">
            <h1 class="article-title" itemprop="name">More on Racket</h1>
        </header>

        <p class="article-byline">
            <a href="https://methanm.github.io/More-on-Racket/" class="article-date">
                <time datetime="2016-09-10T20:15:00.000Z" itemprop="datePublished">2016-09-10</time>
            </a>
        </p>
        <div class="article-entry" itemprop="articleBody"><p>Back in the day, when learning a new programming language, I would take a 
little time and make a random password generator: this is how I learned my
first bit of C as a pimply junior high school student. This predated 
<a href="http://projecteuler.net">Project Euler</a> by quite some time (I think the 
technical term is "a coon's age"), but these days I turn toward those problems
to more systematically get a few chunks of language learning under my belt.
Time hasn't been very plentiful these days&mdash;and in fact I think I'm
brushing off some required duties at the moment&mdash;but I wanted to formalize
a few thoughts.</p>
<p>First, one of the major attractions of Python to me is the rather simple 
concision of the language. When I was programming in Java for school and for
support at work, I was at first really impressed by the way Eclipse could 
generate all that boilerplate code. Hauling up the IDE, though, was painful.
(I only ever found the alternative, Netbeans, useful, I confess, for its
ability to parse C
macros and dump the code out&mdash;this was of inestimable value when
implementing the <a href="http://www.obj-sys.com/blog/?p=739">zero on free</a> feature
of the OSys custom memory manager.)</p>
<p>Only later did I consider that boilerplate code, while it has its place, is a
possible indication that the language itself is a little bloated. Take, for 
example, automatically generated getters and setters. What programmers really
want for the most part is to ignore method calls and instead treat attributes
<strong>as attributes</strong>. The use of properties (implemented in 
<a href="https://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx">C#</a>, <a href="http://stackoverflow.com/questions/8368512/does-c11-have-c-style-properties">as a user hack
in C++11</a>,
not at all in Java, and as a <a href="http://stackoverflow.com/questions/6618002/python-property-versus-getters-and-setters">decorator in Python</a>)
is a convenience for programmers, although the logic goes that properties can
break encapsulation and may not be explicit enough to warn users of the 
interface of potential consequences.</p>
<p>So Python's ability to treat attributes of classes as such without any extra
work on my part (or that of my IDE) and to admit changes if needed by way of 
decorators was welcome. It was short, comprehensible, and required less
code. (Of course, Python doesn't really encapsulate anything&mdash;it, like
Perl, demands quite a bit from programmers to be written well.)</p>
<p>So back to Project Euler; <a href="https://projecteuler.net/problem=2">the second problem</a>
consists of summing even Fibonacci numbers below four million. The bulk of
the work is done in calculating the numbers. This is a great problem for 
learning about the perils of recursion, tail-recursive optimization, and
memoization. The naive solution is computationally very inefficient because
it doesn't reuse calculations from previous iterations (we're building, after
all, from the end to the beginning).</p>
<p>As is often the case in natural languages, sometimes we want to translate
from one language to another; so I thought I would write a Pythonic solution
(in a couple of ways&mdash;the searches always lead you down rabbit trails,
<a href="http://www.jargon.net/jargonfile/t/tailrecursion.html">like the Jargon File definition of tail recursion</a>).
So here are a couple of implementations with some thoughts:</p>
<div class="codehilite"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">add_nth_to_list</span><span class="p">(</span> <span class="n">idx</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">add_nth_to_list</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">num</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">num</span> <span class="p">)</span>
        <span class="n">add_nth_to_list</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
</pre></div>


<p>This is a tail-recursive version, and not one that's particularly great.
Probably it's smarter to make an iterative version instead:</p>
<div class="codehilite"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="n">ln</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
         <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>

   <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>Racket has iterative options (<code>for/list</code> among others) that we could use, 
but it encourages recursion. So here's a first stab at it:</p>
<div class="codehilite"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fib</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">letrec </span><span class="p">((</span><span class="nf">fib-list</span> <span class="p">(</span><span class="nb">list </span><span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">sum-last</span> <span class="p">(</span><span class="err">λ</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">list-ref </span><span class="nv">l</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">length </span><span class="nv">l</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="nf">last</span> <span class="nv">l</span><span class="p">))))</span>
           <span class="p">(</span><span class="nf">add-nth</span> <span class="p">(</span><span class="err">λ</span> <span class="p">(</span><span class="nf">l</span> <span class="nv">n</span><span class="p">)</span>
                      <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">l</span><span class="p">)</span>
                            <span class="p">(</span><span class="k">else </span>
                             <span class="p">(</span><span class="nf">add-nth</span> <span class="p">(</span><span class="nb">append </span><span class="nv">l</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nf">sum-last</span> <span class="nv">l</span><span class="p">)))</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)))))))</span>
    <span class="p">(</span><span class="nf">printf</span> <span class="s">&quot;~a&quot;</span> <span class="p">(</span><span class="nb">list-ref </span><span class="p">(</span><span class="nf">add-nth</span> <span class="nv">fib-list</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">n</span><span class="p">))))</span>
</pre></div>


<p>Really it's a two-line difference: the Racket code is eight lines long, and
the Python seven (not including whitespace). But which is more readable?
I've used some lambdas to make life a little easier to read in the logic
instead of embedding everything, but this is a little like reading German:
to understand the dependent clause you have to skip to the end to get the 
verbs and then go back.</p>
<p>There are more elegant ways to do this, I bet. It'd be nice, for example, 
to use a <code>for/list</code> for iteration instead, or simply <code>map</code>; these would
likely shrink the code-size. On the same token, though, Python also has
<code>map</code> and <code>filter</code> functions (now objects, I guess), or one can use
list comprehensions if desired.</p>
<p>Now probably the real distinction is that Racket will afford more concise code
using <a href="https://docs.racket-lang.org/reference/match.html">pattern matching</a> 
(<a href="http://digitalfreepen.com/2014/08/08/compiler-optimization-ii.html">here's a more explicit example</a>
that uses pattern matching for some code generation tools) and 
<a href="https://docs.racket-lang.org/guide/macros.html">macros</a>. (They're not like
the <a href="https://isocpp.org/wiki/faq/misc-technical-issues#macros-with-if">evil macros</a>
in C/C++.)</p>
<p>I'll be poking and prodding at this as time permits; the conclusion is rushed,
but Real Life intrudes on writing here sometimes.</p></div>
        <footer class="article-footer">
            <a data-url="https://methanm.github.io/https://methanm.github.io/More-on-Racket/" class="article-share-link">Share</a>


            <ul class="article-tag-list">
                <li class="article-tag-list-item"><a class="article-tag-list-link" href="https://methanm.github.io/tags/racket">racket</a></li>
                <li class="article-tag-list-item"><a class="article-tag-list-link" href="https://methanm.github.io/tags/programming">programming</a></li>
            </ul>

        </footer>
    </div>
</article>



                        </div>
                    </section>
                    <aside id="sidebar">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
  <div class="sidebar-top">
    <p>follow:</p>
    <ul class="social-links">






        <li><a class="social-tooltip" title="rss" href="https://methanm.github.io/rss.xml" target="_blank"><i id="icon-rss" class="icon"></i></a></li>

    </ul>
  </div>

  <div class="widgets-container">
        <div class="widget-wrap">
<h3 class="widget-title">recents</h3>
<div class="widget">
    <ul id="recent-post" class="">
        <li>
            <div class="item-thumbnail">
                <a href="https://methanm.github.io/Platform-Partisanship/" class="thumbnail">
                        <span class="thumbnail-image thumbnail-none"></span>
                </a>
            </div>
            <div class="item-inner">
                <p class="item-category">
                    <a class="article-category-link" href="https://methanm.github.io/categories/programming">Programming
                    </a>
                </p>
                <p class="item-title"><a href="https://methanm.github.io/Platform-Partisanship/" class="title">Platform Partisanship</a></p>
                <p class="item-date"><time datetime="2015-03-03T00:13:55.108Z" itemprop="datePublished">2016-09-30</time></p>
            </div>
        </li>
        <li>
            <div class="item-thumbnail">
                <a href="https://methanm.github.io/Racket-and-Euler-4/" class="thumbnail">
                        <span class="thumbnail-image thumbnail-none"></span>
                </a>
            </div>
            <div class="item-inner">
                <p class="item-category">
                    <a class="article-category-link" href="https://methanm.github.io/categories/programming">programming
                    </a>
                </p>
                <p class="item-title"><a href="https://methanm.github.io/Racket-and-Euler-4/" class="title">Racket and Euler 4</a></p>
                <p class="item-date"><time datetime="2015-03-03T00:13:55.108Z" itemprop="datePublished">2016-09-25</time></p>
            </div>
        </li>
        <li>
            <div class="item-thumbnail">
                <a href="https://methanm.github.io/More-on-Racket/" class="thumbnail">
                        <span class="thumbnail-image thumbnail-none"></span>
                </a>
            </div>
            <div class="item-inner">
                <p class="item-category">
                    <a class="article-category-link" href="https://methanm.github.io/categories/programming">programming
                    ,
                    </a>
                    <a class="article-category-link" href="https://methanm.github.io/categories/racket">racket
                    </a>
                </p>
                <p class="item-title"><a href="https://methanm.github.io/More-on-Racket/" class="title">More on Racket</a></p>
                <p class="item-date"><time datetime="2015-03-03T00:13:55.108Z" itemprop="datePublished">2016-09-10</time></p>
            </div>
        </li>
        <li>
            <div class="item-thumbnail">
                <a href="https://methanm.github.io/Racket-and-DSLs/" class="thumbnail">
                        <span class="thumbnail-image thumbnail-none"></span>
                </a>
            </div>
            <div class="item-inner">
                <p class="item-category">
                    <a class="article-category-link" href="https://methanm.github.io/categories/programming">programming
                    </a>
                </p>
                <p class="item-title"><a href="https://methanm.github.io/Racket-and-DSLs/" class="title">Racket and DSLs</a></p>
                <p class="item-date"><time datetime="2015-03-03T00:13:55.108Z" itemprop="datePublished">2016-09-02</time></p>
            </div>
        </li>
        <li>
            <div class="item-thumbnail">
                <a href="https://methanm.github.io/Moving-yet-again/" class="thumbnail">
                        <span class="thumbnail-image thumbnail-none"></span>
                </a>
            </div>
            <div class="item-inner">
                <p class="item-category">
                    <a class="article-category-link" href="https://methanm.github.io/categories/construction">construction
                    </a>
                </p>
                <p class="item-title"><a href="https://methanm.github.io/Moving-yet-again/" class="title">Moving yet again</a></p>
                <p class="item-date"><time datetime="2015-03-03T00:13:55.108Z" itemprop="datePublished">2016-08-28</time></p>
            </div>
        </li>
    </ul>
</div>
</div>

        <div class="widget-wrap widget-list">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
        <ul class="category-list">
                <li class="category-list-item">
                <a class="category-list-link" href="https://methanm.github.io/categories/programming">
                    programming
                </a>
                <span class="category-list-count">10</span>
                </li>
                <li class="category-list-item">
                <a class="category-list-link" href="https://methanm.github.io/categories/construction">
                    construction
                </a>
                <span class="category-list-count">3</span>
                </li>
                <li class="category-list-item">
                <a class="category-list-link" href="https://methanm.github.io/categories/racket">
                    racket
                </a>
                <span class="category-list-count">1</span>
                </li>
        </ul>
    </div>
</div>

        <div class="widget-wrap widget-list">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
        <ul class="archive-list">
                <li class="archive-list-item">
                <a class="archive-list-link" href="https://methanm.github.io/archives/2016/09">Sep 2016</a>
                <span class="archive-list-count">4</span>
                </li>
                <li class="archive-list-item">
                <a class="archive-list-link" href="https://methanm.github.io/archives/2016/08">Aug 2016</a>
                <span class="archive-list-count">1</span>
                </li>
                <li class="archive-list-item">
                <a class="archive-list-link" href="https://methanm.github.io/archives/2016/04">Apr 2016</a>
                <span class="archive-list-count">3</span>
                </li>
                <li class="archive-list-item">
                <a class="archive-list-link" href="https://methanm.github.io/archives/2016/01">Jan 2016</a>
                <span class="archive-list-count">3</span>
                </li>
                <li class="archive-list-item">
                <a class="archive-list-link" href="https://methanm.github.io/archives/2015/11">Nov 2015</a>
                <span class="archive-list-count">2</span>
                </li>
        </ul>
    </div>
</div>

        <div class="widget-wrap widget-float">
<h3 class="widget-title">tag cloud</h3>
<div class="widget tagcloud">
    <a href="https://methanm.github.io/tags/programming" style="font-size: 10px;">programming</a>
    <a href="https://methanm.github.io/tags/racket" style="font-size: 10px;">racket</a>
    <a href="https://methanm.github.io/tags/construction" style="font-size: 10px;">construction</a>
    <a href="https://methanm.github.io/tags/python" style="font-size: 10px;">python</a>
    <a href="https://methanm.github.io/tags/aspect-oriented_programming" style="font-size: 10px;">aspect-oriented programming</a>
    <a href="https://methanm.github.io/tags/premature_optimization" style="font-size: 10px;">premature optimization</a>
    <a href="https://methanm.github.io/tags/programming_potpourri" style="font-size: 10px;">programming potpourri</a>
    <a href="https://methanm.github.io/tags/numpy" style="font-size: 10px;">numpy</a>
    <a href="https://methanm.github.io/tags/tools" style="font-size: 10px;">tools</a>
    <a href="https://methanm.github.io/tags/dsls" style="font-size: 10px;">dsls</a>
    <a href="https://methanm.github.io/tags/euler" style="font-size: 10px;">euler</a>
</div>
</div>


  </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
<div class="container">
    <div class="container-inner">
        <a id="back-to-top" href="javascript:;"><i class="icon" id="icon-angle-up"></i></a>
        <div class="credit">
            <h1 class="logo-wrap">
                <a href="https://methanm.github.io/" class="logo">Ethan's Thoughts</a>
            </h1>
            <p>© 2015 Ethan</p>
            <p>Powered by <a href="//crotal.org/" target="_blank">Crotal</a>. Theme by <a href="http://alxmedia.se/themes/hueman/" target="_blank">Alexander Agnarson</a></p>
        </div>
    </div>
</div>
</footer>

</body>

    <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>





<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="https://methanm.github.io/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>
<script src="https://methanm.github.io/scrollLoading/jquery.scrollLoading.js" type="text/javascript"></script>
<script src="https://methanm.github.io/scrollLoading/main.js" type="text/javascript"></script>
<script src="https://methanm.github.io/js/html-patch.js" type="text/javascript"></script>
<script src="https://methanm.github.io/js/script.js" type="text/javascript"></script>



